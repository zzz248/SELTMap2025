
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Diagnostic Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body { height: 100%; margin: 0; font-family: sans-serif; }
    #map { height: 80%; }
    #controls { padding: 10px; background: white; }
    #debug { padding: 10px; background: #f4f4f4; font-size: 0.9em; }
  </style>
</head>
<body>
  <div id="controls">
    <label for="yearSelect">Select Year:</label>
    <select id="yearSelect">
      <option value="2009" >2009</option><option value="2010" >2010</option><option value="2011" >2011</option><option value="2012" >2012</option><option value="2013" >2013</option><option value="2014" >2014</option><option value="2015" >2015</option><option value="2016" >2016</option><option value="2017" >2017</option><option value="2018" >2018</option><option value="2019" >2019</option><option value="2020" >2020</option><option value="2021" >2021</option><option value="2022" >2022</option><option value="2023" >2023</option><option value="2024" >2024</option>
    </select>
  </div>
  <div id="debug">
    <strong>Debug Info:</strong>
    <pre id="debugOutput">Waiting for map...</pre>
  </div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const stateData = {"AK": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "No Activity", "2021": "No Activity", "2022": "No Activity", "2023": "No Activity", "2024": "No Activity"}, "AL": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "AR": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "AZ": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "CA": {"2009": "No Activity", "2010": "No Activity", "2011": "Enacted Two", "2012": "Enacted Two", "2013": "Enacted Two", "2014": "Enacted Two", "2015": "Enacted Two", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Two", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "CO": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "CT": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "DC": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "DE": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted Two", "2019": "Enacted Three", "2020": "Enacted Three", "2021": "Enacted Three", "2022": "Enacted Three", "2023": "Enacted Three", "2024": "Enacted Three"}, "FL": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "Enacted Two", "2015": "Enacted Two", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Two", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "GA": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "HI": {"2009": "No Activity", "2010": "No Activity", "2011": "Enacted One", "2012": "Enacted and Failed", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "IA": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "No Activity", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "ID": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "IL": {"2009": "No Activity", "2010": "Enacted One", "2011": "Enacted One", "2012": "Enacted Two", "2013": "Enacted Two", "2014": "Enacted Two", "2015": "Enacted Two", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Two", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "IN": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "KS": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "KY": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "LA": {"2009": "No Activity", "2010": "Enacted One", "2011": "Enacted One", "2012": "Enacted Two", "2013": "Enacted Two", "2014": "Enacted Two", "2015": "Enacted Two", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Two", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "MA": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "Enacted and Failed", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "MD": {"2009": "No Activity", "2010": "Enacted One", "2011": "Enacted Two", "2012": "Enacted and Failed", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "ME": {"2009": "No Activity", "2010": "Enacted One", "2011": "Enacted One", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "MI": {"2009": "Enacted One", "2010": "Enacted One", "2011": "Enacted One", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "MN": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "MO": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "No Activity", "2021": "No Activity", "2022": "No Activity", "2023": "No Activity", "2024": "No Activity"}, "MS": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "No Activity", "2021": "No Activity", "2022": "No Activity", "2023": "No Activity", "2024": "No Activity"}, "MT": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "NC": {"2009": "No Activity", "2010": "No Activity", "2011": "Enacted One", "2012": "Enacted One", "2013": "Enacted and Repealed", "2014": "Enacted and Repealed", "2015": "Enacted and Repealed", "2016": "Enacted and Repealed", "2017": "Enacted and Repealed", "2018": "Enacted and Repealed", "2019": "Enacted and Repealed", "2020": "Enacted and Repealed", "2021": "Enacted and Repealed", "2022": "Enacted and Repealed", "2023": "Enacted and Repealed", "2024": "Enacted and Repealed"}, "ND": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "No Activity", "2021": "No Activity", "2022": "No Activity", "2023": "No Activity", "2024": "No Activity"}, "NE": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "NH": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "NJ": {"2009": "No Activity", "2010": "No Activity", "2011": "Enacted One", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "NM": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "NV": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "NY": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "Enacted and Failed", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "OH": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "OK": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "Enacted One", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "OR": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "PA": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Two", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "RI": {"2009": "No Activity", "2010": "No Activity", "2011": "Enacted One", "2012": "Enacted One", "2013": "Enacted Two", "2014": "Enacted Two", "2015": "Enacted Two", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Two", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "SC": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "SD": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "No Activity", "2018": "No Activity", "2019": "No Activity", "2020": "No Activity", "2021": "No Activity", "2022": "No Activity", "2023": "No Activity", "2024": "No Activity"}, "TN": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "TX": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "UT": {"2009": "Enacted One", "2010": "Enacted One", "2011": "Enacted One", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted Two", "2015": "Enacted Two", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Three", "2019": "Enacted Three", "2020": "Enacted Three", "2021": "Enacted Three", "2022": "Enacted Three", "2023": "Enacted Three", "2024": "Enacted Three"}, "VA": {"2009": "No Activity", "2010": "No Activity", "2011": "Enacted and Failed", "2012": "Enacted and Failed", "2013": "Enacted and Failed", "2014": "Enacted and Failed", "2015": "Enacted and Failed", "2016": "Enacted and Failed", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "VT": {"2009": "Enacted One", "2010": "Enacted Two", "2011": "Enacted Two", "2012": "Enacted Two", "2013": "Enacted Two", "2014": "Enacted Two", "2015": "Enacted Two", "2016": "Enacted Two", "2017": "Enacted Two", "2018": "Enacted Two", "2019": "Enacted Two", "2020": "Enacted Two", "2021": "Enacted Two", "2022": "Enacted Two", "2023": "Enacted Two", "2024": "Enacted Two"}, "WA": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "WI": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "No Activity", "2015": "No Activity", "2016": "No Activity", "2017": "Enacted and Failed", "2018": "Enacted and Failed", "2019": "Enacted and Failed", "2020": "Enacted and Failed", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}, "WV": {"2009": "No Activity", "2010": "No Activity", "2011": "No Activity", "2012": "No Activity", "2013": "No Activity", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted One", "2022": "Enacted One", "2023": "Enacted One", "2024": "Enacted One"}, "WY": {"2009": "No Activity", "2010": "Enacted One", "2011": "Enacted One", "2012": "Enacted One", "2013": "Enacted One", "2014": "Enacted One", "2015": "Enacted One", "2016": "Enacted One", "2017": "Enacted One", "2018": "Enacted One", "2019": "Enacted One", "2020": "Enacted One", "2021": "Enacted and Failed", "2022": "Enacted and Failed", "2023": "Enacted and Failed", "2024": "Enacted and Failed"}};

    function getColor(activity) {
      if (!activity) return "#ff0000"; // red for missing
      const a = activity.trim();
      if (a.includes("No Activity")) return "#000000";
      if (a.includes("Enacted One")) return "#00abce";
      if (a.includes("Enacted Two")) return "#00abce";
      if (a.includes("Enacted and Failed")) return "#73a535";
      if (a.includes("Failed")) return "#702b9d";
      if (a.includes("Repealed")) return "#925333";
      if (a.includes("Under Consideration")) return "#330662";
      return "#ff00ff"; // magenta for unrecognized
    }

    let map, geojson;

    function updateDebug(abbr, year, activity) {
      const output = `
State: ${abbr}
Year: ${year}
Activity: ${activity}
Raw stateData[abbr]: ${JSON.stringify(stateData[abbr], null, 2)}
      `;
      document.getElementById("debugOutput").textContent = output;
    }

    function getActivity(stateAbbr, year) {
      const raw = stateData[stateAbbr];
      const act = raw && raw[year] ? raw[year].trim() : "";
      console.log("Lookup:", stateAbbr, year, "→", act);
      return act;
    }

    function styleFeature(feature) {
      const year = document.getElementById("yearSelect").value;
      const abbr = feature.properties.postal;
      const activity = getActivity(abbr, year);
      updateDebug(abbr, year, activity);
      return {
        fillColor: getColor(activity),
        weight: 1,
        opacity: 1,
        color: 'white',
        fillOpacity: 0.7
      };
    }

    function onEachFeature(feature, layer) {
      const year = document.getElementById("yearSelect").value;
      const abbr = feature.properties.postal;
      const activity = getActivity(abbr, year);
      layer.bindPopup(`<strong>${abbr}</strong>: ${activity}`);
    }

    function updateMap() {
      const year = document.getElementById("yearSelect").value;
      geojson.eachLayer(layer => {
        const abbr = layer.feature.properties.postal;
        const activity = getActivity(abbr, year);
        layer.setStyle({ fillColor: getColor(activity) });
        layer.setPopupContent(`<strong>${abbr}</strong>: ${activity}`);
      });
    }

    function initMap() {
      map = L.map('map').setView([37.8, -96], 4);
      L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 6,
        attribution: '© OpenStreetMap'
      }).addTo(map);

      fetch("https://raw.githubusercontent.com/PublicaMundi/MappingAPI/master/data/geojson/us-states.json")
        .then(res => res.json())
        .then(data => {
          geojson = L.geoJson(data, {
            style: styleFeature,
            onEachFeature: onEachFeature
          }).addTo(map);
        });
    }

    document.addEventListener("DOMContentLoaded", function () {
      initMap();
      document.getElementById("yearSelect").addEventListener("change", updateMap);
    });
  </script>
</body>
</html>
